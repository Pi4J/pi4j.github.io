<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.80.0"><meta name=description content="Java IO Library for the Raspberry Pi"><meta name=author content="Pi4J"><link rel=icon href=/assets/favicon.ico type=image/ico><title>Serial Peripheral Interface (SPI) - Pi4J</title><link href=/css/nucleus.css?1650886687 rel=stylesheet><link href=/css/fontawesome-all.min.css?1650886687 rel=stylesheet><link href=/css/hybrid.css?1650886687 rel=stylesheet><link href=/css/featherlight.min.css?1650886687 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1650886687 rel=stylesheet><link href=/css/auto-complete.css?1650886687 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1650886687 rel=stylesheet><link href=/css/theme.css?1650886687 rel=stylesheet><link href=/css/hugo-theme.css?1650886687 rel=stylesheet><link href=/css/theme-blue.css?1650886687 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1650886687></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/io-examples/spi/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><img src=/assets/pi4j-header.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1650886687></script><script type=text/javascript src=/js/auto-complete.js?1650886687></script><script type=text/javascript>var baseurl="https:\/\/pi4j.com\/";</script><script type=text/javascript src=/js/search.js?1650886687></script></div><section id=homelinks><ul><li><a class=padding href=/><i class="fas fa-home"></i>Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/about/ title=About class=dd-item><a href=/about/>About</a><ul><li data-nav-id=/about/previous-version-v1/ title="Previous versions (V.1)" class=dd-item><a href=/about/previous-version-v1/>Previous versions (V.1)</a></li><li data-nav-id=/about/new-in-v2/ title="What's New (V.2)" class=dd-item><a href=/about/new-in-v2/>What's New (V.2)</a></li><li data-nav-id=/about/release-notes/ title="Release Notes" class=dd-item><a href=/about/release-notes/>Release Notes</a></li><li data-nav-id=/about/license/ title="License (Open Source)" class=dd-item><a href=/about/license/>License (Open Source)</a></li><li data-nav-id=/about/team/ title="The Team" class=dd-item><a href=/about/team/>The Team</a></li></ul></li><li data-nav-id=/getting-started/ title="Getting started with Pi4J" class=dd-item><a href=/getting-started/>Getting started with Pi4J</a><ul><li data-nav-id=/getting-started/set-up-a-new-raspberry-pi/ title="Set up a new Raspberry Pi" class=dd-item><a href=/getting-started/set-up-a-new-raspberry-pi/>Set up a new Raspberry Pi</a></li><li data-nav-id=/getting-started/understanding-the-pins/ title="Understanding the GPIO pins" class=dd-item><a href=/getting-started/understanding-the-pins/>Understanding the GPIO pins</a></li><li data-nav-id=/getting-started/java-development-on-the-raspberry-pi-with-vsc/ title="Java development with VSC" class=dd-item><a href=/getting-started/java-development-on-the-raspberry-pi-with-vsc/>Java development with VSC</a></li><li data-nav-id=/getting-started/developing-on-a-remote-pc/ title="Developing on a remote PC" class=dd-item><a href=/getting-started/developing-on-a-remote-pc/>Developing on a remote PC</a></li><li data-nav-id=/getting-started/minimal-example-application/ title="Minimal example application" class=dd-item><a href=/getting-started/minimal-example-application/>Minimal example application</a></li><li data-nav-id=/getting-started/minimal-example-application-fatjar/ title="Minimal example as FAT JAR" class=dd-item><a href=/getting-started/minimal-example-application-fatjar/>Minimal example as FAT JAR</a></li><li data-nav-id=/getting-started/crowpi/ title="Electronics with CrowPi" class=dd-item><a href=/getting-started/crowpi/>Electronics with CrowPi</a><ul><li data-nav-id=/getting-started/crowpi/crowpi-os/ title="CrowPi OS" class=dd-item><a href=/getting-started/crowpi/crowpi-os/>CrowPi OS</a></li><li data-nav-id=/getting-started/crowpi/develop-with-intellij/ title="Develop with Intellij IDEA" class=dd-item><a href=/getting-started/crowpi/develop-with-intellij/>Develop with Intellij IDEA</a></li></ul></li><li data-nav-id=/getting-started/user-interface-with-javafx/ title="User interface with JavaFX" class=dd-item><a href=/getting-started/user-interface-with-javafx/>User interface with JavaFX</a></li><li data-nav-id=/getting-started/fxgl/ title="Game development with FXGL" class=dd-item><a href=/getting-started/fxgl/>Game development with FXGL</a><ul><li data-nav-id=/getting-started/fxgl/fxgl-to-picade/ title="FXGl to Picade" class=dd-item><a href=/getting-started/fxgl/fxgl-to-picade/>FXGl to Picade</a></li><li data-nav-id=/getting-started/fxgl/kiosk-mode/ title="JavaFX kiosk mode" class=dd-item><a href=/getting-started/fxgl/kiosk-mode/>JavaFX kiosk mode</a></li></ul></li><li data-nav-id=/getting-started/javafx-mvc-template/ title="JavaFX GUI and MVC template" class=dd-item><a href=/getting-started/javafx-mvc-template/>JavaFX GUI and MVC template</a></li><li data-nav-id=/getting-started/learn-more/ title="Learn more..." class=dd-item><a href=/getting-started/learn-more/>Learn more...</a></li></ul></li><li data-nav-id=/documentation/ title=Documentation class="dd-item
parent"><a href=/documentation/>Documentation</a><ul><li data-nav-id=/documentation/pin-numbering/ title="Pin numbering" class=dd-item><a href=/documentation/pin-numbering/>Pin numbering</a></li><li data-nav-id=/documentation/java-installation/ title="Java for ARMv6/7/8" class=dd-item><a href=/documentation/java-installation/>Java for ARMv6/7/8</a></li><li data-nav-id=/documentation/logging/ title="Logging with SLF4J" class=dd-item><a href=/documentation/logging/>Logging with SLF4J</a></li><li data-nav-id=/documentation/create-context/ title="Creating a Pi4J Context" class=dd-item><a href=/documentation/create-context/>Creating a Pi4J Context</a></li><li data-nav-id=/documentation/platforms/ title="Choosing a Platform" class=dd-item><a href=/documentation/platforms/>Choosing a Platform</a><ul><li data-nav-id=/documentation/platforms/raspberry-pi/ title="Raspberry Pi" class=dd-item><a href=/documentation/platforms/raspberry-pi/>Raspberry Pi</a></li></ul></li><li data-nav-id=/documentation/providers/ title="Choosing an I/O Provider" class=dd-item><a href=/documentation/providers/>Choosing an I/O Provider</a><ul><li data-nav-id=/documentation/providers/linuxfs/ title=LinuxFS class=dd-item><a href=/documentation/providers/linuxfs/>LinuxFS</a></li><li data-nav-id=/documentation/providers/pigpio/ title=PiGpio class=dd-item><a href=/documentation/providers/pigpio/>PiGpio</a></li></ul></li><li data-nav-id=/documentation/build-io/ title="Building an I/O Instance" class=dd-item><a href=/documentation/build-io/>Building an I/O Instance</a></li><li data-nav-id=/documentation/io-examples/ title="I/O Examples" class="dd-item
parent"><a href=/documentation/io-examples/>I/O Examples</a><ul><li data-nav-id=/documentation/io-examples/digital-output/ title="Digital Output (GPIO)" class=dd-item><a href=/documentation/io-examples/digital-output/>Digital Output (GPIO)</a></li><li data-nav-id=/documentation/io-examples/digital-input/ title="Digital Input (GPIO)" class=dd-item><a href=/documentation/io-examples/digital-input/>Digital Input (GPIO)</a></li><li data-nav-id=/documentation/io-examples/pwm/ title="Pulse Width Modulation (PWM)" class=dd-item><a href=/documentation/io-examples/pwm/>Pulse Width Modulation (PWM)</a></li><li data-nav-id=/documentation/io-examples/i2c/ title="Inter-Integrated Circuit (I²C)" class=dd-item><a href=/documentation/io-examples/i2c/>Inter-Integrated Circuit (I²C)</a><ul><li data-nav-id=/documentation/io-examples/i2c/clock-stretching/ title="I²C Clock Stretching" class=dd-item><a href=/documentation/io-examples/i2c/clock-stretching/>I²C Clock Stretching</a></li></ul></li><li data-nav-id=/documentation/io-examples/spi/ title="Serial Peripheral Interface (SPI)" class="dd-item active"><a href=/documentation/io-examples/spi/>Serial Peripheral Interface (SPI)</a></li><li data-nav-id=/documentation/io-examples/serial/ title="Serial (UART/RS232)" class=dd-item><a href=/documentation/io-examples/serial/>Serial (UART/RS232)</a></li></ul></li><li data-nav-id=/documentation/device-examples/ title="Devices examples" class=dd-item><a href=/documentation/device-examples/>Devices examples</a><ul><li data-nav-id=/documentation/device-examples/simplebutton/ title="Simple Button" class=dd-item><a href=/documentation/device-examples/simplebutton/>Simple Button</a></li><li data-nav-id=/documentation/device-examples/simpleled/ title="Simple LED" class=dd-item><a href=/documentation/device-examples/simpleled/>Simple LED</a></li><li data-nav-id=/documentation/device-examples/joystick/ title=Joystick class=dd-item><a href=/documentation/device-examples/joystick/>Joystick</a></li></ul></li><li data-nav-id=/documentation/registry/ title="I/O Registry" class=dd-item><a href=/documentation/registry/>I/O Registry</a></li><li data-nav-id=/documentation/shutdown/ title="Shutting down the Pi4J Context" class=dd-item><a href=/documentation/shutdown/>Shutting down the Pi4J Context</a></li><li data-nav-id=/documentation/building/ title="Building and running" class=dd-item><a href=/documentation/building/>Building and running</a><ul><li data-nav-id=/documentation/building/javac/ title="Building with javac" class=dd-item><a href=/documentation/building/javac/>Building with javac</a></li><li data-nav-id=/documentation/building/fat-jar/ title="Build as a FAT JAR with Maven" class=dd-item><a href=/documentation/building/fat-jar/>Build as a FAT JAR with Maven</a></li><li data-nav-id=/documentation/building/modules-maven/ title="Build Java modules with Maven" class=dd-item><a href=/documentation/building/modules-maven/>Build Java modules with Maven</a></li><li data-nav-id=/documentation/building/modules-gradle/ title="Build Java modules with Gradle" class=dd-item><a href=/documentation/building/modules-gradle/>Build Java modules with Gradle</a></li><li data-nav-id=/documentation/building/jbang/ title="Running Pi4J with JBang" class=dd-item><a href=/documentation/building/jbang/>Running Pi4J with JBang</a></li></ul></li></ul></li><li data-nav-id=/architecture/ title=Architecture/Design class=dd-item><a href=/architecture/>Architecture/Design</a><ul><li data-nav-id=/architecture/about-the-code/ title="Project source structure" class=dd-item><a href=/architecture/about-the-code/>Project source structure</a><ul><li data-nav-id=/architecture/about-the-code/download/ title=Download/Install class=dd-item><a href=/architecture/about-the-code/download/>Download/Install</a><ul><li data-nav-id=/architecture/about-the-code/download/direct-download/ title="Direct Download" class=dd-item><a href=/architecture/about-the-code/download/direct-download/>Direct Download</a></li><li data-nav-id=/architecture/about-the-code/download/install/ title=Installation class=dd-item><a href=/architecture/about-the-code/download/install/>Installation</a></li></ul></li><li data-nav-id=/architecture/about-the-code/build-instructions/ title="Build Instructions" class=dd-item><a href=/architecture/about-the-code/build-instructions/>Build Instructions</a></li><li data-nav-id=/architecture/about-the-code/maven-settings/ title="Maven settings" class=dd-item><a href=/architecture/about-the-code/maven-settings/>Maven settings</a></li><li data-nav-id=/architecture/about-the-code/code-styling/ title="Code styling" class=dd-item><a href=/architecture/about-the-code/code-styling/>Code styling</a></li><li data-nav-id=/architecture/about-the-code/hardware-testing/ title="Hardware testing" class=dd-item><a href=/architecture/about-the-code/hardware-testing/>Hardware testing</a></li></ul></li><li data-nav-id=/architecture/advanced/ title=Advanced class=dd-item><a href=/architecture/advanced/>Advanced</a><ul><li data-nav-id=/architecture/advanced/annotated-provisioning/ title="Annotated provisioning" class=dd-item><a href=/architecture/advanced/annotated-provisioning/>Annotated provisioning</a></li><li data-nav-id=/architecture/advanced/dependency-injection/ title="Dependency injection" class=dd-item><a href=/architecture/advanced/dependency-injection/>Dependency injection</a></li><li data-nav-id=/architecture/advanced/library-path/ title="Native Library Path" class=dd-item><a href=/architecture/advanced/library-path/>Native Library Path</a></li><li data-nav-id=/architecture/advanced/plugins/ title=Plug-ins class=dd-item><a href=/architecture/advanced/plugins/>Plug-ins</a></li><li data-nav-id=/architecture/advanced/remote-support/ title="Remote support" class=dd-item><a href=/architecture/advanced/remote-support/>Remote support</a></li><li data-nav-id=/architecture/advanced/3rd-party/ title="Third-Party Integration" class=dd-item><a href=/architecture/advanced/3rd-party/>Third-Party Integration</a></li></ul></li><li data-nav-id=/architecture/pi4j-logo/ title="The Pi4J Logo" class=dd-item><a href=/architecture/pi4j-logo/>The Pi4J Logo</a></li></ul></li><li data-nav-id=/featured-projects/ title="Featured Projects" class=dd-item><a href=/featured-projects/>Featured Projects</a><ul><li data-nav-id=/featured-projects/soft-real-time-plc-written-in-strolch/ title="Soft real time PLC" class=dd-item><a href=/featured-projects/soft-real-time-plc-written-in-strolch/>Soft real time PLC</a></li><li data-nav-id=/featured-projects/pijukebox-by-daniel-martensson/ title=PiJukeBox class=dd-item><a href=/featured-projects/pijukebox-by-daniel-martensson/>PiJukeBox</a></li><li data-nav-id=/featured-projects/cocktail-maker-by-alex9849/ title="Cocktail Maker" class=dd-item><a href=/featured-projects/cocktail-maker-by-alex9849/>Cocktail Maker</a></li><li data-nav-id=/featured-projects/street-artist-robot/ title="Didier the street artist robot" class=dd-item><a href=/featured-projects/street-artist-robot/>Didier the street artist robot</a></li><li data-nav-id=/featured-projects/joystick-game/ title="JMonkeyEngine with Joystick" class=dd-item><a href=/featured-projects/joystick-game/>JMonkeyEngine with Joystick</a></li><li data-nav-id=/featured-projects/sensor-drivers/ title="Sensor drivers" class=dd-item><a href=/featured-projects/sensor-drivers/>Sensor drivers</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://pi4j.com/tags><i class="fas fa-tags"></i>Tags</a></li><li><a class=padding href=https://github.com/Pi4J><i class="fab fa-github"></i>GitHub project</a></li><li><a class=padding href=https://twitter.com/pi4J><i class="fab fa-twitter"></i>Twitter @pi4j</a></li><li><a class=padding href=https://github.com/Pi4J/pi4j-v2/discussions><i class="fab fa-github"></i>Pi4J Forum</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/Pi4J/pi4j.github.io/blob/main/content/documentation/io-examples/spi.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/>Welcome to Pi4J</a> > <a href=/documentation/>Documentation</a> > <a href=/documentation/io-examples/>I/O Examples</a> > Serial Peripheral Interface (SPI)</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#what-is-it>What is it?</a></li><li><a href=#uses>Uses</a></li><li><a href=#addressing>Addressing</a></li><li><a href=#additional-information>Additional Information</a></li><li><a href=#code-example>Code example</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/spi>SPI</a></div></div><div id=body-inner><h1>Serial Peripheral Interface (SPI)</h1><h2 id=what-is-it>What is it?</h2><p>The Serial Peripheral Interface, abbreviated to SPI, is a bus system which enables
communication between a main device (called “master”) and one or more secondary devices
(called “slave”). A direct communication between all participants is not possible here,
much more the master can choose at any time with which slave he would like to exchange data.</p><p>In order to address only one slave, a total of 3 signal lines are required, two of which
are used for bidirectional data transmission and one as a clock generator for serial
transmission. If further slaves are to be addressed, additional signal lines are required
depending on the desired topology.</p><h2 id=uses>Uses</h2><p>In addition to communication between microcontrollers, SPI is also used to address
numerous sensors and actuators. Similar to I²C, a large number of control commands and
data can be transmitted in both directions with a relatively high clock rate over 3 lines.
A particular advantage here is the support for “full duplex”, ie the simultaneous
transmission of data in both directions.</p><p>The technical implementation is very simple and is also used, for example, to communicate
with SD cards. The Nintendo Game Boy already used this protocol to connect several game
consoles via the Game Boy Link Cable.</p><h2 id=addressing>Addressing</h2><p>As already mentioned in the first section, multiple slaves can also be connected to SPI.
The number available depends on the hardware used. On the Raspberry Pi, the standard SPI0
with two different slaves use what is called Chip Select Pins is controlled.</p><h2 id=additional-information>Additional Information</h2><ul><li><a href=https://en.wikipedia.org/wiki/Serial_Peripheral_Interface>Wikipedia SPI</a></li><li><a href=https://pinout.xyz/pinout/spi#>SPI pinout for Raspberry Pi</a></li></ul><h2 id=code-example>Code example</h2><p>Initialize the Pi4J Context with a provider which supports SPI fully, e.g. the PiGpioSpiProvider. The minimal example
would be:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>var piGpio <span style=color:#f92672>=</span> PiGpio<span style=color:#f92672>.</span><span style=color:#a6e22e>newNativeInstance</span><span style=color:#f92672>();</span>
var pi4j <span style=color:#f92672>=</span> Pi4J<span style=color:#f92672>.</span><span style=color:#a6e22e>newContextBuilder</span><span style=color:#f92672>()</span>
    <span style=color:#f92672>.</span><span style=color:#a6e22e>noAutoDetect</span><span style=color:#f92672>()</span>
    <span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>
        PiGpioSpiProvider<span style=color:#f92672>.</span><span style=color:#a6e22e>newInstance</span><span style=color:#f92672>(</span>piGpio<span style=color:#f92672>)</span>
    <span style=color:#f92672>)</span>
    <span style=color:#f92672>.</span><span style=color:#a6e22e>build</span><span style=color:#f92672>();</span>
</code></pre></div><p>Depending on the type of GPIOs you need in your project this could be further extended to e.g.:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>var piGpio <span style=color:#f92672>=</span> PiGpio<span style=color:#f92672>.</span><span style=color:#a6e22e>newNativeInstance</span><span style=color:#f92672>();</span>
var pi4j <span style=color:#f92672>=</span> Pi4J<span style=color:#f92672>.</span><span style=color:#a6e22e>newContextBuilder</span><span style=color:#f92672>()</span>
    <span style=color:#f92672>.</span><span style=color:#a6e22e>noAutoDetect</span><span style=color:#f92672>()</span>
    <span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>
        PiGpioDigitalInputProvider<span style=color:#f92672>.</span><span style=color:#a6e22e>newInstance</span><span style=color:#f92672>(</span>piGpio<span style=color:#f92672>),</span>
        PiGpioDigitalOutputProvider<span style=color:#f92672>.</span><span style=color:#a6e22e>newInstance</span><span style=color:#f92672>(</span>piGpio<span style=color:#f92672>),</span>
        PiGpioPwmProvider<span style=color:#f92672>.</span><span style=color:#a6e22e>newInstance</span><span style=color:#f92672>(</span>piGpio<span style=color:#f92672>),</span>
        PiGpioI2CProvider<span style=color:#f92672>.</span><span style=color:#a6e22e>newInstance</span><span style=color:#f92672>(</span>piGpio<span style=color:#f92672>),</span>
        PiGpioSerialProvider<span style=color:#f92672>.</span><span style=color:#a6e22e>newInstance</span><span style=color:#f92672>(</span>piGpio<span style=color:#f92672>),</span>
        PiGpioSpiProvider<span style=color:#f92672>.</span><span style=color:#a6e22e>newInstance</span><span style=color:#f92672>(</span>piGpio<span style=color:#f92672>)</span>
    <span style=color:#f92672>)</span>
    <span style=color:#f92672>.</span><span style=color:#a6e22e>build</span><span style=color:#f92672>();</span>
</code></pre></div><p>The following example is an extract of the <a href=/getting-started/crowpi/>CrowPi example project</a> which includes
a component to control an 8x8 LED matrix display with an MAX7219 driver chip which is controlled via SPI.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MAX7219</span> <span style=color:#66d9ef>extends</span> Component <span style=color:#f92672>{</span>
    <span style=color:#75715e>// MAX7219: Internal Commands
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> CMD_SET_FIRST_ROW <span style=color:#f92672>=</span> 0x01<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> CMD_DECODE_MODE <span style=color:#f92672>=</span> 0x09<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> CMD_INTENSITY <span style=color:#f92672>=</span> 0x0A<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> CMD_SCAN_LIMIT <span style=color:#f92672>=</span> 0x0B<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> CMD_SHUTDOWN <span style=color:#f92672>=</span> 0x0C<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> CMD_DISPLAY_TEST <span style=color:#f92672>=</span> 0x0F<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Width of MAX7219 LED matrix
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> WIDTH <span style=color:#f92672>=</span> 8<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Height of MAX7219 LED matrix
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> HEIGHT <span style=color:#f92672>=</span> 8<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Internal buffer to store the 8x8 matrix
</span><span style=color:#75715e>     * A byte[] array is used as each of the 8 bits is used to represent a column
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> buffer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>HEIGHT<span style=color:#f92672>];</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Pi4J SPI instance
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>final</span> Spi spi<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Creates a new MAX7219 instance using the given SPI instance from Pi4J.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param spi SPI instance
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>MAX7219</span><span style=color:#f92672>(</span>Spi spi<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>spi</span> <span style=color:#f92672>=</span> spi<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Clears the internal buffer without refreshing the display.
</span><span style=color:#75715e>     * This means that the current contents of the displays are still being shown until {@link #refresh()} is called.
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>clear</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>fill</span><span style=color:#f92672>(</span>buffer<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 0<span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Flushes the internal buffer for all rows to the chip, causing it to be displayed.
</span><span style=color:#75715e>     * The contents of the buffer will be preserved by this command.
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>refresh</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> row <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> row <span style=color:#f92672>&lt;</span> HEIGHT<span style=color:#f92672>;</span> row<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
            refreshRow<span style=color:#f92672>(</span>row<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Flushes the internal buffer for a single row to the chip, causing it to be displayed.
</span><span style=color:#75715e>     * The contents of the buffer will be preserved by this command.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param row Row to be flushed
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>refreshRow</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> row<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>row <span style=color:#f92672>&lt;</span> 0 <span style=color:#f92672>||</span> row <span style=color:#f92672>&gt;=</span> HEIGHT<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalArgumentException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Row must be an integer in the range 0-&#34;</span> <span style=color:#f92672>+</span> HEIGHT<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>

        execute<span style=color:#f92672>((</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>CMD_SET_FIRST_ROW <span style=color:#f92672>+</span> row<span style=color:#f92672>),</span> buffer<span style=color:#f92672>[</span>row<span style=color:#f92672>]);</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Specifies if the LED matrix should be enabled or disabled.
</span><span style=color:#75715e>     * This will also setup the proper decoding mode and scan limit when enabling the chip.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param enabled LED matrix state (true = ON, false = OFF)
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setEnabled</span><span style=color:#f92672>(</span><span style=color:#66d9ef>boolean</span> enabled<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>enabled<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            execute<span style=color:#f92672>(</span>CMD_SHUTDOWN<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 0x01<span style=color:#f92672>);</span>
            execute<span style=color:#f92672>(</span>CMD_DECODE_MODE<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 0x00<span style=color:#f92672>);</span>
            execute<span style=color:#f92672>(</span>CMD_SCAN_LIMIT<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 0x07<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
            execute<span style=color:#f92672>(</span>CMD_SHUTDOWN<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 0x00<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Enables or disables the testing mode of the LED matrix.
</span><span style=color:#75715e>     * When enabled, all other options (including {@link #setEnabled(boolean)} are ignored and all LEDs are turned on.
</span><span style=color:#75715e>     * To actually control the chip, the test mode MUST be disabled.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param enabled Test mode state (true = ON, false = OFF)
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setTestMode</span><span style=color:#f92672>(</span><span style=color:#66d9ef>boolean</span> enabled<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        execute<span style=color:#f92672>(</span>CMD_DISPLAY_TEST<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>enabled <span style=color:#f92672>?</span> 0x01 <span style=color:#f92672>:</span> 0x00<span style=color:#f92672>));</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Changes the desired brightness for the LED matrix.
</span><span style=color:#75715e>     * This method expects an integer value within the range 0-15, with 0 being the dimmest and 15 the brightest possible value.
</span><span style=color:#75715e>     * The whole display is affected by this command which gets immediately applied.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param brightness Desired brightness from 0-15
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setBrightness</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> brightness<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>brightness <span style=color:#f92672>&lt;</span> 0 <span style=color:#f92672>||</span> brightness <span style=color:#f92672>&gt;</span> 15<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalArgumentException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Brightness must be an integer in the range 0-15&#34;</span><span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
        execute<span style=color:#f92672>(</span>CMD_INTENSITY<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> brightness<span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Enables or disables the pixel at the given X/Y position within the internal buffer.
</span><span style=color:#75715e>     * This change will not be visible until {@link #refresh()} or {@link #refreshRow(int)} gets called.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param x       X position to change
</span><span style=color:#75715e>     * @param y       Y position to change
</span><span style=color:#75715e>     * @param enabled Desired pixel state (true = ON, false = OFF)
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setPixel</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> y<span style=color:#f92672>,</span> <span style=color:#66d9ef>boolean</span> enabled<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#75715e>// Ensure coordinates are within boundaries
</span><span style=color:#75715e></span>        checkPixelBounds<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>);</span>

        <span style=color:#75715e>// Generate bitmask and set/unset specific bit
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> mask <span style=color:#f92672>=</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>1 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#f92672>(</span>WIDTH <span style=color:#f92672>-</span> 1 <span style=color:#f92672>-</span> x<span style=color:#f92672>));</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>enabled<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            buffer<span style=color:#f92672>[</span>y<span style=color:#f92672>]</span> <span style=color:#f92672>|=</span> mask<span style=color:#f92672>;</span>
        <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
            buffer<span style=color:#f92672>[</span>y<span style=color:#f92672>]</span> <span style=color:#f92672>&amp;=</span> <span style=color:#f92672>~</span>mask<span style=color:#f92672>;</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Retrieves the pixel at the given X/Y position within the internal buffer.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param x X position to change
</span><span style=color:#75715e>     * @param y Y position to change
</span><span style=color:#75715e>     * @return Current state of specified pixel (true = ON, false = OFF)
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>getPixel</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#75715e>// Ensure coordinates are within boundaries
</span><span style=color:#75715e></span>        checkPixelBounds<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>);</span>

        <span style=color:#75715e>// Generate bitmask and retrieve specific bit
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> mask <span style=color:#f92672>=</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> <span style=color:#f92672>(</span>1 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#f92672>(</span>WIDTH <span style=color:#f92672>-</span> 1 <span style=color:#f92672>-</span> x<span style=color:#f92672>));</span>
        <span style=color:#66d9ef>return</span> <span style=color:#f92672>(</span>buffer<span style=color:#f92672>[</span>y<span style=color:#f92672>]</span> <span style=color:#f92672>&amp;</span> mask<span style=color:#f92672>)</span> <span style=color:#f92672>!=</span> 0<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Ensures the given X and Y coordinates are within the boundaries of this LED matrix.
</span><span style=color:#75715e>     * An {@link IllegalArgumentException} will be thrown if outside.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param x X coordinate to check
</span><span style=color:#75715e>     * @param y Y coordinate to check
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>checkPixelBounds</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>x <span style=color:#f92672>&lt;</span> 0 <span style=color:#f92672>||</span> x <span style=color:#f92672>&gt;=</span> WIDTH<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalArgumentException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;X must be an integer in the range 0-&#34;</span> <span style=color:#f92672>+</span> WIDTH<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>y <span style=color:#f92672>&lt;</span> 0 <span style=color:#f92672>||</span> y <span style=color:#f92672>&gt;=</span> WIDTH<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalArgumentException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Y must be an integer in the range 0-&#34;</span> <span style=color:#f92672>+</span> HEIGHT<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * Helper method for sending a command to the MAX7219 chip with data. Communication happens over SPI by simply sending two pieces of
</span><span style=color:#75715e>     * data, more specifically the desired command as a byte value, followed by the data as another byte value.
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @param command Command to be executed
</span><span style=color:#75715e>     * @param data    Data for the given command
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>execute</span><span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span> command<span style=color:#f92672>,</span> <span style=color:#66d9ef>byte</span> data<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        spi<span style=color:#f92672>.</span><span style=color:#a6e22e>write</span><span style=color:#f92672>(</span>command<span style=color:#f92672>,</span> data<span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1650886687></script><script src=/js/perfect-scrollbar.min.js?1650886687></script><script src=/js/perfect-scrollbar.jquery.min.js?1650886687></script><script src=/js/jquery.sticky.js?1650886687></script><script src=/js/featherlight.min.js?1650886687></script><script src=/js/highlight.pack.js?1650886687></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js?1650886687></script><script src=/js/learn.js?1650886687></script><script src=/js/hugo-learn.js?1650886687></script><script src=/mermaid/mermaid.js?1650886687></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>