<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.142.0"><meta name=description content="Java IO Library for the Raspberry Pi"><meta name=author content="Pi4J"><link rel=icon href=/assets/favicon.ico type=image/ico><title>Pixelblaze Output Expander - Pi4J</title>
<link href=/css/nucleus.css?1738069976 rel=stylesheet><link href=/css/fontawesome-all.min.css?1738069976 rel=stylesheet><link href=/css/hybrid.css?1738069976 rel=stylesheet><link href=/css/featherlight.min.css?1738069976 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1738069976 rel=stylesheet><link href=/css/auto-complete.css?1738069976 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1738069976 rel=stylesheet><link href=/css/theme.css?1738069976 rel=stylesheet><link href=/css/hugo-theme.css?1738069976 rel=stylesheet><link href=/css/theme-blue.css?1738069976 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1738069976></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><style>.DocSearch{width:90%}#docsearch-input{border:none;padding-top:15px;margin:0 0 0 10px;padding:0;background:0 0}</style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3></pre></li></head><body data-url=/examples/jbang/pixelblaze_output_expander/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><img src=/assets/pi4j-header.png></a></div><div id=docsearch></div></div><section id=homelinks><ul><li><a class=padding href=/><i class='fas fa-home'></i> Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/about/ title=About class=dd-item><a href=/about/>About</a><ul><li data-nav-id=/about/previous-version-v1/ title="Previous versions (V.1)" class=dd-item><a href=/about/previous-version-v1/>Previous versions (V.1)</a></li><li data-nav-id=/about/new-in-v2/ title="What's New (V.2)" class=dd-item><a href=/about/new-in-v2/>What's New (V.2)</a></li><li data-nav-id=/about/release-notes/ title="Release Notes" class=dd-item><a href=/about/release-notes/>Release Notes</a></li><li data-nav-id=/about/download/ title="Pi4J Downloads" class=dd-item><a href=/about/download/>Pi4J Downloads</a></li><li data-nav-id=/about/license/ title="License (Open Source)" class=dd-item><a href=/about/license/>License (Open Source)</a></li><li data-nav-id=/about/team/ title="The Team" class=dd-item><a href=/about/team/>The Team</a></li></ul></li><li data-nav-id=/prepare/ title="Prepare a Raspberry Pi" class=dd-item><a href=/prepare/>Prepare a Raspberry Pi</a><ul><li data-nav-id=/prepare/sd-card/ title="Write OS to SD card" class=dd-item><a href=/prepare/sd-card/>Write OS to SD card</a></li><li data-nav-id=/prepare/first-boot/ title="The First Boot" class=dd-item><a href=/prepare/first-boot/>The First Boot</a></li><li data-nav-id=/prepare/install-java/ title="Install Java and Tools" class=dd-item><a href=/prepare/install-java/>Install Java and Tools</a></li></ul></li><li data-nav-id=/getting-started/ title="Getting Started With Pi4J" class=dd-item><a href=/getting-started/>Getting Started With Pi4J</a><ul><li data-nav-id=/getting-started/understanding-the-pins/ title="Understanding the GPIO pins" class=dd-item><a href=/getting-started/understanding-the-pins/>Understanding the GPIO pins</a></li><li data-nav-id=/getting-started/electrical-engineering/ title="Electrical Engineering" class=dd-item><a href=/getting-started/electrical-engineering/>Electrical Engineering</a></li><li data-nav-id=/getting-started/java-development-on-the-raspberry-pi-with-vsc/ title="Java development with VSC" class=dd-item><a href=/getting-started/java-development-on-the-raspberry-pi-with-vsc/>Java development with VSC</a></li><li data-nav-id=/getting-started/developing-on-a-remote-pc/ title="Developing on a remote PC" class=dd-item><a href=/getting-started/developing-on-a-remote-pc/>Developing on a remote PC</a></li><li data-nav-id=/getting-started/minimal-example-application/ title="Minimal example application" class=dd-item><a href=/getting-started/minimal-example-application/>Minimal example application</a></li><li data-nav-id=/getting-started/minimal-example-application-fatjar/ title="Minimal example as FAT JAR" class=dd-item><a href=/getting-started/minimal-example-application-fatjar/>Minimal example as FAT JAR</a></li><li data-nav-id=/getting-started/user-interface-with-javafx/ title="User interface with JavaFX" class=dd-item><a href=/getting-started/user-interface-with-javafx/>User interface with JavaFX</a></li><li data-nav-id=/getting-started/fxgl/ title="Game development with FXGL" class=dd-item><a href=/getting-started/fxgl/>Game development with FXGL</a><ul><li data-nav-id=/getting-started/fxgl/fxgl-to-picade/ title="FXGl to Picade" class=dd-item><a href=/getting-started/fxgl/fxgl-to-picade/>FXGl to Picade</a></li><li data-nav-id=/getting-started/fxgl/kiosk-mode/ title="JavaFX kiosk mode" class=dd-item><a href=/getting-started/fxgl/kiosk-mode/>JavaFX kiosk mode</a></li></ul></li><li data-nav-id=/getting-started/javafx-mvc-template/ title="JavaFX GUI and MVC template" class=dd-item><a href=/getting-started/javafx-mvc-template/>JavaFX GUI and MVC template</a></li><li data-nav-id=/getting-started/learn-more/ title="Learn more..." class=dd-item><a href=/getting-started/learn-more/>Learn more...</a></li></ul></li><li data-nav-id=/documentation/ title=Documentation class=dd-item><a href=/documentation/>Documentation</a><ul><li data-nav-id=/documentation/pin-numbering/ title="Pin numbering" class=dd-item><a href=/documentation/pin-numbering/>Pin numbering</a></li><li data-nav-id=/documentation/java-for-arm/ title="Java for ARMv6/7/8" class=dd-item><a href=/documentation/java-for-arm/>Java for ARMv6/7/8</a></li><li data-nav-id=/documentation/logging/ title="Logging with SLF4J" class=dd-item><a href=/documentation/logging/>Logging with SLF4J</a></li><li data-nav-id=/documentation/create-context/ title="Creating a Pi4J Context" class=dd-item><a href=/documentation/create-context/>Creating a Pi4J Context</a></li><li data-nav-id=/documentation/platforms/ title="Choosing a Platform" class=dd-item><a href=/documentation/platforms/>Choosing a Platform</a><ul><li data-nav-id=/documentation/platforms/raspberry-pi/ title="Raspberry Pi" class=dd-item><a href=/documentation/platforms/raspberry-pi/>Raspberry Pi</a></li></ul></li><li data-nav-id=/documentation/providers/ title="Choosing an I/O Provider" class=dd-item><a href=/documentation/providers/>Choosing an I/O Provider</a><ul><li data-nav-id=/documentation/providers/gpiod/ title="GpioD Provider" class=dd-item><a href=/documentation/providers/gpiod/>GpioD Provider</a></li><li data-nav-id=/documentation/providers/linuxfs/ title="LinuxFS Provider" class=dd-item><a href=/documentation/providers/linuxfs/>LinuxFS Provider</a></li><li data-nav-id=/documentation/providers/pigpio/ title="PiGpio Provider" class=dd-item><a href=/documentation/providers/pigpio/>PiGpio Provider</a></li></ul></li><li data-nav-id=/documentation/board-info/ title="Using Board Info" class=dd-item><a href=/documentation/board-info/>Using Board Info</a></li><li data-nav-id=/documentation/build-io/ title="Building an I/O Instance" class=dd-item><a href=/documentation/build-io/>Building an I/O Instance</a></li><li data-nav-id=/documentation/io-examples/ title="I/O Examples" class=dd-item><a href=/documentation/io-examples/>I/O Examples</a><ul><li data-nav-id=/documentation/io-examples/digital-output/ title="Digital Output (GPIO)" class=dd-item><a href=/documentation/io-examples/digital-output/>Digital Output (GPIO)</a></li><li data-nav-id=/documentation/io-examples/digital-input/ title="Digital Input (GPIO)" class=dd-item><a href=/documentation/io-examples/digital-input/>Digital Input (GPIO)</a></li><li data-nav-id=/documentation/io-examples/pwm/ title="Pulse Width Modulation (PWM)" class=dd-item><a href=/documentation/io-examples/pwm/>Pulse Width Modulation (PWM)</a></li><li data-nav-id=/documentation/io-examples/i2c/ title="Inter-Integrated Circuit (I²C)" class=dd-item><a href=/documentation/io-examples/i2c/>Inter-Integrated Circuit (I²C)</a><ul><li data-nav-id=/documentation/io-examples/i2c/clock-stretching/ title="I²C Clock Stretching" class=dd-item><a href=/documentation/io-examples/i2c/clock-stretching/>I²C Clock Stretching</a></li></ul></li><li data-nav-id=/documentation/io-examples/spi/ title="Serial Peripheral Interface (SPI)" class=dd-item><a href=/documentation/io-examples/spi/>Serial Peripheral Interface (SPI)</a></li><li data-nav-id=/documentation/io-examples/serial/ title="Serial (UART/RS232)" class=dd-item><a href=/documentation/io-examples/serial/>Serial (UART/RS232)</a></li></ul></li><li data-nav-id=/documentation/registry/ title="I/O Registry" class=dd-item><a href=/documentation/registry/>I/O Registry</a></li><li data-nav-id=/documentation/shutdown/ title="Shutting down the Pi4J Context" class=dd-item><a href=/documentation/shutdown/>Shutting down the Pi4J Context</a></li><li data-nav-id=/documentation/building/ title="Building and running" class=dd-item><a href=/documentation/building/>Building and running</a><ul><li data-nav-id=/documentation/building/javac/ title="Building with javac" class=dd-item><a href=/documentation/building/javac/>Building with javac</a></li><li data-nav-id=/documentation/building/fat-jar/ title="Build as a FAT JAR with Maven" class=dd-item><a href=/documentation/building/fat-jar/>Build as a FAT JAR with Maven</a></li><li data-nav-id=/documentation/building/modules-maven/ title="Build Java modules with Maven" class=dd-item><a href=/documentation/building/modules-maven/>Build Java modules with Maven</a></li><li data-nav-id=/documentation/building/modules-gradle/ title="Build Java modules with Gradle" class=dd-item><a href=/documentation/building/modules-gradle/>Build Java modules with Gradle</a></li><li data-nav-id=/documentation/building/jbang/ title="Running Pi4J with JBang" class=dd-item><a href=/documentation/building/jbang/>Running Pi4J with JBang</a></li></ul></li></ul></li><li data-nav-id=/examples/ title="Example Implementations" class="dd-item
parent"><a href=/examples/>Example Implementations</a><ul><li data-nav-id=/examples/jbang/ title="JBang Examples" class="dd-item
parent"><a href=/examples/jbang/>JBang Examples</a><ul><li data-nav-id=/examples/jbang/jbang_minimal_example/ title="Minimal Example" class=dd-item><a href=/examples/jbang/jbang_minimal_example/>Minimal Example</a></li><li data-nav-id=/examples/jbang/jbang_pi4j_spi_led_matrix/ title="8x8 LED Matrix" class=dd-item><a href=/examples/jbang/jbang_pi4j_spi_led_matrix/>8x8 LED Matrix</a></li><li data-nav-id=/examples/jbang/bme280_temperature_humidity_pressure/ title="BME280 Sensor" class=dd-item><a href=/examples/jbang/bme280_temperature_humidity_pressure/>BME280 Sensor</a></li><li data-nav-id=/examples/jbang/pixelblaze_output_expander/ title="Pixelblaze Output Expander" class="dd-item active"><a href=/examples/jbang/pixelblaze_output_expander/>Pixelblaze Output Expander</a></li><li data-nav-id=/examples/jbang/pixelblaze_output_expander_image/ title="Controlling a LED Matrix" class=dd-item><a href=/examples/jbang/pixelblaze_output_expander_image/>Controlling a LED Matrix</a></li><li data-nav-id=/examples/jbang/pixelblaze_output_expander_javafx/ title="LED strip with a JavaFX UI" class=dd-item><a href=/examples/jbang/pixelblaze_output_expander_javafx/>LED strip with a JavaFX UI</a></li></ul></li><li data-nav-id=/examples/components/ title="Component Examples" class=dd-item><a href=/examples/components/>Component Examples</a><ul><li data-nav-id=/examples/components/simplebutton/ title="Simple Button" class=dd-item><a href=/examples/components/simplebutton/>Simple Button</a></li><li data-nav-id=/examples/components/simpleled/ title="Simple LED" class=dd-item><a href=/examples/components/simpleled/>Simple LED</a></li><li data-nav-id=/examples/components/ads1115/ title="AD Converter ADS1115" class=dd-item><a href=/examples/components/ads1115/>AD Converter ADS1115</a></li><li data-nav-id=/examples/components/buzzer/ title=Buzzer class=dd-item><a href=/examples/components/buzzer/>Buzzer</a></li><li data-nav-id=/examples/components/camera/ title=Camera class=dd-item><a href=/examples/components/camera/>Camera</a></li><li data-nav-id=/examples/components/joystick/ title=Joystick class=dd-item><a href=/examples/components/joystick/>Joystick</a></li><li data-nav-id=/examples/components/joystickanalog/ title="Joystick Analog" class=dd-item><a href=/examples/components/joystickanalog/>Joystick Analog</a></li><li data-nav-id=/examples/components/lcddisplay/ title="LCD Display" class=dd-item><a href=/examples/components/lcddisplay/>LCD Display</a></li><li data-nav-id=/examples/components/ledbutton/ title="LED Button" class=dd-item><a href=/examples/components/ledbutton/>LED Button</a></li><li data-nav-id=/examples/components/ledmatrix/ title="LED Matrix" class=dd-item><a href=/examples/components/ledmatrix/>LED Matrix</a></li><li data-nav-id=/examples/components/ledstrip/ title="LED Strip" class=dd-item><a href=/examples/components/ledstrip/>LED Strip</a></li><li data-nav-id=/examples/components/potentiometer/ title=Potentiometer class=dd-item><a href=/examples/components/potentiometer/>Potentiometer</a></li><li data-nav-id=/examples/components/servo/ title=ServoMotor class=dd-item><a href=/examples/components/servo/>ServoMotor</a></li></ul></li><li data-nav-id=/examples/crowpi/ title="Electronics with CrowPi" class=dd-item><a href=/examples/crowpi/>Electronics with CrowPi</a><ul><li data-nav-id=/examples/crowpi/develop-crowpi-with-intellij/ title="Develop with Intellij IDEA" class=dd-item><a href=/examples/crowpi/develop-crowpi-with-intellij/>Develop with Intellij IDEA</a></li><li data-nav-id=/examples/crowpi/crowpi-examples/ title="CrowPi examples" class=dd-item><a href=/examples/crowpi/crowpi-examples/>CrowPi examples</a></li></ul></li><li data-nav-id=/examples/communityimplementation/ title="Community Implementations" class=dd-item><a href=/examples/communityimplementation/>Community Implementations</a><ul><li data-nav-id=/examples/communityimplementation/prototype-board/ title="Prototype Board" class=dd-item><a href=/examples/communityimplementation/prototype-board/>Prototype Board</a></li><li data-nav-id=/examples/communityimplementation/bmp280/ title="BMP280 Sensor" class=dd-item><a href=/examples/communityimplementation/bmp280/>BMP280 Sensor</a></li></ul></li></ul></li><li data-nav-id=/debugging-failures/ title="Debugging Failures" class=dd-item><a href=/debugging-failures/>Debugging Failures</a></li><li data-nav-id=/architecture/ title=Architecture/Design class=dd-item><a href=/architecture/>Architecture/Design</a><ul><li data-nav-id=/architecture/about-the-code/ title="Project source structure" class=dd-item><a href=/architecture/about-the-code/>Project source structure</a><ul><li data-nav-id=/architecture/about-the-code/download-sources/ title=Download/Install class=dd-item><a href=/architecture/about-the-code/download-sources/>Download/Install</a></li><li data-nav-id=/architecture/about-the-code/build-instructions/ title="Build Instructions" class=dd-item><a href=/architecture/about-the-code/build-instructions/>Build Instructions</a></li><li data-nav-id=/architecture/about-the-code/maven-settings/ title="Maven settings" class=dd-item><a href=/architecture/about-the-code/maven-settings/>Maven settings</a></li><li data-nav-id=/architecture/about-the-code/code-styling/ title="Code styling" class=dd-item><a href=/architecture/about-the-code/code-styling/>Code styling</a></li><li data-nav-id=/architecture/about-the-code/hardware-testing/ title="Hardware testing" class=dd-item><a href=/architecture/about-the-code/hardware-testing/>Hardware testing</a></li></ul></li><li data-nav-id=/architecture/advanced/ title=Advanced class=dd-item><a href=/architecture/advanced/>Advanced</a><ul><li data-nav-id=/architecture/advanced/annotated-provisioning/ title="Annotated provisioning" class=dd-item><a href=/architecture/advanced/annotated-provisioning/>Annotated provisioning</a></li><li data-nav-id=/architecture/advanced/dependency-injection/ title="Dependency injection" class=dd-item><a href=/architecture/advanced/dependency-injection/>Dependency injection</a></li><li data-nav-id=/architecture/advanced/library-path/ title="Native Library Path" class=dd-item><a href=/architecture/advanced/library-path/>Native Library Path</a></li><li data-nav-id=/architecture/advanced/plugins/ title=Plug-ins class=dd-item><a href=/architecture/advanced/plugins/>Plug-ins</a></li><li data-nav-id=/architecture/advanced/remote-support/ title="Remote support" class=dd-item><a href=/architecture/advanced/remote-support/>Remote support</a></li></ul></li><li data-nav-id=/architecture/pi4j-logo/ title="The Pi4J Logo" class=dd-item><a href=/architecture/pi4j-logo/>The Pi4J Logo</a></li></ul></li><li data-nav-id=/kotlin/ title="Pi4J Kotlin DSL" class=dd-item><a href=/kotlin/>Pi4J Kotlin DSL</a><ul><li data-nav-id=/kotlin/minimal-kotlin-example/ title="Minimal Kotlin Pi4J example" class=dd-item><a href=/kotlin/minimal-kotlin-example/>Minimal Kotlin Pi4J example</a></li><li data-nav-id=/kotlin/kotlin-api-docs/ title="Kotlin API & DSL Documentation" class=dd-item><a href=/kotlin/kotlin-api-docs/>Kotlin API & DSL Documentation</a></li><li data-nav-id=/kotlin/coroutines/ title="Coroutines Support" class=dd-item><a href=/kotlin/coroutines/>Coroutines Support</a></li><li data-nav-id=/kotlin/i2c/ title="I²C Kotlin DSL" class=dd-item><a href=/kotlin/i2c/>I²C Kotlin DSL</a></li><li data-nav-id=/kotlin/serial/ title="Serial Kotlin DSL" class=dd-item><a href=/kotlin/serial/>Serial Kotlin DSL</a></li></ul></li><li data-nav-id=/blog/ title=Blogs class=dd-item><a href=/blog/>Blogs</a><ul><li data-nav-id=/blog/2025/20250115-miami-jug/ title="Pi4J presentation for Miami JUG" class=dd-item><a href=/blog/2025/20250115-miami-jug/>Pi4J presentation for Miami JUG</a></li><li data-nav-id=/blog/2024/20241114-floss-weekly-podcast/ title="Pi4J in Floss Weekly" class=dd-item><a href=/blog/2024/20241114-floss-weekly-podcast/>Pi4J in Floss Weekly</a></li><li data-nav-id=/blog/2024/20241104-download-stats/ title="Maven Downloads" class=dd-item><a href=/blog/2024/20241104-download-stats/>Maven Downloads</a></li><li data-nav-id=/blog/2024/20240927-bits-bytes-signed-unsigned/ title="Signed versus unsigned values" class=dd-item><a href=/blog/2024/20240927-bits-bytes-signed-unsigned/>Signed versus unsigned values</a></li><li data-nav-id=/blog/2024/20240517_bosch_sensor_gas_measurement/ title="Bosch sensor gas measurement" class=dd-item><a href=/blog/2024/20240517_bosch_sensor_gas_measurement/>Bosch sensor gas measurement</a></li><li data-nav-id=/blog/2024/20240425_interview_tom_aarts/ title="Interview Tom Aarts" class=dd-item><a href=/blog/2024/20240425_interview_tom_aarts/>Interview Tom Aarts</a></li><li data-nav-id=/blog/2024/20240423_pwm_rpi5/ title="PWM Hardware Support on RPi5" class=dd-item><a href=/blog/2024/20240423_pwm_rpi5/>PWM Hardware Support on RPi5</a></li><li data-nav-id=/blog/2024/20240419_interview_robert_von_burg/ title="Interview Robert von Burg" class=dd-item><a href=/blog/2024/20240419_interview_robert_von_burg/>Interview Robert von Burg</a></li><li data-nav-id=/blog/2024/20240418_i2c_improvements/ title="Ongoing I2C Improvements" class=dd-item><a href=/blog/2024/20240418_i2c_improvements/>Ongoing I2C Improvements</a></li><li data-nav-id=/blog/2024/20240417_led_matrix_max7219_spi_web/ title="LED Matrix with SPI MAX7219" class=dd-item><a href=/blog/2024/20240417_led_matrix_max7219_spi_web/>LED Matrix with SPI MAX7219</a></li><li data-nav-id=/blog/2024/20240318_interview_alexander_liggesmeyer/ title="Alexander Liggesmeyer and RPi5" class=dd-item><a href=/blog/2024/20240318_interview_alexander_liggesmeyer/>Alexander Liggesmeyer and RPi5</a></li><li data-nav-id=/blog/2022/20221128_led_strip_with_jbang/ title="LED strip with Pi4J and JBang" class=dd-item><a href=/blog/2022/20221128_led_strip_with_jbang/>LED strip with Pi4J and JBang</a></li><li data-nav-id=/blog/2022/20221117_kotlin_on_raspberrypi/ title="Kotlin on the Raspberry Pi" class=dd-item><a href=/blog/2022/20221117_kotlin_on_raspberrypi/>Kotlin on the Raspberry Pi</a></li><li data-nav-id=/blog/2022/20220113_javafx_pi4j_template/ title="Getting Started Template" class=dd-item><a href=/blog/2022/20220113_javafx_pi4j_template/>Getting Started Template</a></li></ul></li><li data-nav-id=/featured-projects/ title="Featured Projects" class=dd-item><a href=/featured-projects/>Featured Projects</a><ul><li data-nav-id=/featured-projects/binary-clock/ title="Binary Clock" class=dd-item><a href=/featured-projects/binary-clock/>Binary Clock</a></li><li data-nav-id=/featured-projects/soft-real-time-plc-written-in-strolch/ title="Soft real time PLC" class=dd-item><a href=/featured-projects/soft-real-time-plc-written-in-strolch/>Soft real time PLC</a></li><li data-nav-id=/featured-projects/pijukebox-by-daniel-martensson/ title=PiJukeBox class=dd-item><a href=/featured-projects/pijukebox-by-daniel-martensson/>PiJukeBox</a></li><li data-nav-id=/featured-projects/cocktail-maker-by-alex9849/ title=CocktailPi class=dd-item><a href=/featured-projects/cocktail-maker-by-alex9849/>CocktailPi</a></li><li data-nav-id=/featured-projects/street-artist-robot/ title="Didier the street artist robot" class=dd-item><a href=/featured-projects/street-artist-robot/>Didier the street artist robot</a></li><li data-nav-id=/featured-projects/joystick-game/ title="JMonkeyEngine with Joystick" class=dd-item><a href=/featured-projects/joystick-game/>JMonkeyEngine with Joystick</a></li><li data-nav-id=/featured-projects/sensor-drivers/ title="Sensor drivers" class=dd-item><a href=/featured-projects/sensor-drivers/>Sensor drivers</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://pi4j.com/tags target=_blank><i class='fas more-tag fa-tags'></i> Tags</a></li><li><a class=padding href=https://github.com/Pi4J target=_blank><i class='fab more-tag fa-github'></i> GitHub project</a></li><li><a class=padding href=https://foojay.social/@pi4j target=_blank rel=me><i class='fab more-tag fa-mastodon'></i> Mastodon @pi4j@foojay.social</a></li><li><a class=padding href=https://www.linkedin.com/company/pi4j/ target=_blank><i class='fab more-tag fa-linkedin'></i> LinkedIn @pi4j</a></li><li><a class=padding href=https://github.com/Pi4J/pi4j-v2/discussions target=_blank><i class='fab more-tag fa-github'></i> Pi4J V2 Discussions</a></li><li><a class=padding href=https://join.slack.com/t/pi4j/shared_invite/zt-1ttqt8wgj-E6t69qaLrNuCMPLiYnBCsg target=_blank><i class='fab more-tag fa-slack'></i> Join our Slack</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p><p>Visitor counter by <a href=https://clicky.com/101436354 target=_blank rel=noopener>Clicky</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Pi4J/pi4j.github.io/blob/main/content/examples/jbang/pixelblaze_output_expander.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/>Welcome to Pi4J</a> > <a href=/examples/>Example Implementations</a> > <a href=/examples/jbang/>JBang Examples</a> > Pixelblaze Output Expander</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#led-strips>LED Strips</a><ul><li><a href=#led-strips-used-in-the-examples>LED Strips Used in the Examples</a></li><li><a href=#how-data-is-handled-by-led-strips>How Data is Handled by LED Strips</a></li></ul></li><li><a href=#wiring>Wiring</a><ul><li><a href=#enabling-serial>Enabling Serial</a></li><li><a href=#status-of-the-pixelblaze-output-expander-leds>Status of the Pixelblaze Output Expander LEDs</a></li></ul></li><li><a href=#application>Application</a><ul><li><a href=#helperpixelblazeoutputexpanderhelper>helper.PixelBlazeOutputExpanderHelper</a></li><li><a href=#pixelblazeoutputexpander>PixelblazeOutputExpander</a></li></ul></li><li><a href=#running-the-application>Running the Application</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/jbang>JBang</a>
<a class=tag-link href=/tags/pixelblaze>Pixelblaze</a>
<a class=tag-link href=/tags/led-strip>LED Strip</a></div></div><div id=body-inner><h1>Pixelblaze Output Expander</h1><div class="notices tip"><p>GITHUB PROJECT: <a href=https://github.com/Pi4J/pi4j-jbang/blob/main/PixelblazeOutputExpander.java target=_blank rel=noopener>github.com/Pi4J/pi4j-jbang > PixelblazeOutputExpander.java</a></p></div><p>One of the most &ldquo;fancy&rdquo; electronic components is definitely a LED strip. It&rsquo;s really cool to control a long strip of lights with only a few lines of code&mldr; But, there is a problem. The timing of the signals is crucial to reliably control these strips. Both Python and Java on a Raspberry Pi can struggle with these timings as they are running on Linux, a non-real-time operating system. So pauses in the garbage collection of the Java virtual machine, or any glitch in the operating system can cause unexpected effects on the LED strips. That&rsquo;s why in most projects, a microcontroller (Arduino, Raspberry Pi Pico, ESP32,&mldr;) is used to drive the LED strip.</p><p>Full LED strip code walkthrough, and additional info in this live session with with Robert (aka Eitch) and Frank:</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/eToIXACqSuY?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><h2 id=intro>Intro</h2><p>This example is using such approach with the <a href=https://shop.electromage.com/products/pixelblaze-output-expander-serial-to-8x-ws2812-apa102-driver target=_blank rel=noopener>Pixelblaze Output Expander (PBOE)</a>. This product was initially intended to connect more LED strips to the <a href=https://shop.electromage.com/products/pixelblaze-v3-standard-wifi-led-controller target=_blank rel=noopener>Pixelblaze V3 Standard - WiFi LED Controller</a> and <a href=https://shop.electromage.com/products/pixelblaze-v3-pico-tiny-wifi-led-controller target=_blank rel=noopener>Pixelblaze V3 Pico - Tiny WiFi LED Controller</a>. But because the expander is controlled through a serial connection, we can also use it with a Raspberry Pi.</p><p>You can buy this component here:</p><ul><li>Directly from the creator of the Pixelblaze in the US: <a href=https://shop.electromage.com/products/pixelblaze-output-expander-serial-to-8x-ws2812-apa102-driver target=_blank rel=noopener>ElectroMage</a>.</li><li>Outside of the US:<ul><li>UK: <a href=https://dialslv.com/product/expander/ target=_blank rel=noopener>DialSLV</a></li><li><a href="https://www.mouser.be/ProductDetail/Hencke-Technologies/EM-O3?qs=QNEnbhJQKvY7RFy9Q0t0MA%3D%3D" target=_blank rel=noopener>Mouser</a> but doesn&rsquo;t ship to consumers in the EU/UK because it isn’t CE-certified.</li></ul></li></ul><h2 id=led-strips>LED Strips</h2><h3 id=led-strips-used-in-the-examples>LED Strips Used in the Examples</h3><p>The LED strips used in these examples, contain LEDs of the WS2812B type, which means they have SMD 5050-LEDs with an integrated IC-driver, so they can be addressed separately. A few examples:</p><ul><li><a href=https://www.amazon.nl/dp/B08Y8QXTCL target=_blank rel=noopener>LED strip on Amazon</a></li><li><a href=https://www.amazon.nl/dp/B0B81R484Z target=_blank rel=noopener>LED matrix on Amazon</a></li><li><a href=https://www.ebay.de/b/WS2812B-LEDs/bn_7005777392 target=_blank rel=noopener>Many variants on ebay</a></li></ul><h3 id=how-data-is-handled-by-led-strips>How Data is Handled by LED Strips</h3><p>To control such a LED strip, you need to send it a byte array with RGB (red/green/blue) values. Let&rsquo;s use an example for a strip with three LEDs, on which you want to show:</p><ol><li>Full red (RGB #FF0000)</li><li>Not full white (RGB #A6A6A6)</li><li>Full blue (RGB #0000FF)</li></ol><div class="notices tip"><p>Although you may be used to use the color ordering RGB for e.g. CSS or in drawing applications, LED strips actually use GRB.</p></div><p>This means, we need a byte array with 9 values:</p><table><thead><tr><th style=text-align:left>Array index</th><th style=text-align:right>0</th><th style=text-align:right>1</th><th style=text-align:right>2</th><th style=text-align:right>3</th><th style=text-align:right>4</th><th style=text-align:right>5</th><th style=text-align:right>6</th><th style=text-align:right>7</th><th style=text-align:right>8</th></tr></thead><tbody><tr><td style=text-align:left>LED</td><td style=text-align:right>1</td><td style=text-align:right></td><td style=text-align:right></td><td style=text-align:right>2</td><td style=text-align:right></td><td style=text-align:right></td><td style=text-align:right>3</td><td style=text-align:right></td><td style=text-align:right></td></tr><tr><td style=text-align:left>G, R, B</td><td style=text-align:right>#00</td><td style=text-align:right>#FF</td><td style=text-align:right>#00</td><td style=text-align:right>#A6</td><td style=text-align:right>#A6</td><td style=text-align:right>#A6</td><td style=text-align:right>#00</td><td style=text-align:right>#00</td><td style=text-align:right>#FF</td></tr></tbody></table><p>The IC of the first led will take the first 3 values from the byte array and output the remaining part to the second LED:</p><table><thead><tr><th style=text-align:left>Array index</th><th style=text-align:right>0</th><th style=text-align:right>1</th><th style=text-align:right>2</th><th style=text-align:right>3</th><th style=text-align:right>4</th><th style=text-align:right>5</th></tr></thead><tbody><tr><td style=text-align:left>LED</td><td style=text-align:right>2</td><td style=text-align:right></td><td style=text-align:right></td><td style=text-align:right>3</td><td style=text-align:right></td><td style=text-align:right></td></tr><tr><td style=text-align:left>G, R, B</td><td style=text-align:right>#A6</td><td style=text-align:right>#A6</td><td style=text-align:right>#A6</td><td style=text-align:right>#00</td><td style=text-align:right>#00</td><td style=text-align:right>#FF</td></tr></tbody></table><p>Again, the second LED will take the first 3 values and output the remaining part:</p><table><thead><tr><th style=text-align:left>Array index</th><th style=text-align:right>0</th><th style=text-align:right>1</th><th style=text-align:right>2</th></tr></thead><tbody><tr><td style=text-align:left>LED</td><td style=text-align:right>3</td><td style=text-align:right></td><td style=text-align:right></td></tr><tr><td style=text-align:left>G, R, B</td><td style=text-align:right>#00</td><td style=text-align:right>#00</td><td style=text-align:right>#FF</td></tr></tbody></table><p>For this system to work correctly, a strict timing of the data signal is needed. Otherwise the IC will handle parts of the data as being a new package, and you&rsquo;ll get unexpected results.</p><p>This is a timing diagram from a datasheet of <a href=https://cdn-shop.adafruit.com/datasheets/WS2812B.pdf target=_blank rel=noopener>WS2812B Intelligent control LED integrated light source</a>:</p><div class="gallery caption-position-bottom caption-effect-slide hover-effect-zoom hover-transition" itemscope itemtype=http://schema.org/ImageGallery><link rel=stylesheet href=/css/hugo-easy-gallery.css><div class="box fancy-figure caption-position-center caption-effect-fade"><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(/assets/examples/jbang/pixelblaze/led-strip-timings.png)><img itemprop=thumbnail src=/assets/examples/jbang/pixelblaze/led-strip-timings.png alt="Timing of the signals for an LED strip"></div><a href=/assets/examples/jbang/pixelblaze/led-strip-timings.png itemprop=contentUrl></a><figcaption><p>Timing of the signals for an LED strip</p></figcaption></figure></div></div><h2 id=wiring>Wiring</h2><p>To control the PBOE, we actually only need one wire to be connected to the Raspberry Pi (RPi) for the serial data to be sent from RPi to PBOE. But we must not forget one important fact: a LED strip with a lot of LEDs will require more power than the RPi can supply. So we need an external power supply that is dimensioned correctly to provide all the power needed for the strip when all LEDs are at maximum level. As a guideline, 0,1W ~ 0,3W/LED is required per LED. For a strip with 60 LEDs/meter, that means 18W/meter, or a total of 90W for a 5-meter strip. That&rsquo;s almost 20A at 5V!</p><div class="notices warning"><p>Use an <strong>external power supply to power LED strips</strong>!!! The 5V of the Raspberry Pi is passed straight through from the USB and the current is therefore limited. <a href=https://raspberrypi.stackexchange.com/questions/9298/what-is-the-maximum-current-the-gpio-pins-can-output target=_blank rel=noopener>Here is a good question with clear answers about this topic on StackExchange</a>.</p></div><p>Connections between RPi, PBOE, and power supply:</p><ul><li>GND PBOE to GND power supply, common with GND of RPi</li><li>5V PBOE to external power supply</li><li>DAT PBOE to BCM14 on Rpi (pin 8 = UART Tx)</li></ul><p>Connections between PBOE and LED strip:</p><ul><li>Din to PBOE Channel 0, Data</li><li>5V to PBOE Channel 0, 5V</li><li>GND to PBOE Channel 0, GND</li></ul><p><div class="gallery caption-position-bottom caption-effect-slide hover-effect-zoom hover-transition" itemscope itemtype=http://schema.org/ImageGallery><div class="box fancy-figure caption-position-center caption-effect-fade"><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(/assets/examples/jbang/pixelblaze/full-setup.jpg)><img itemprop=thumbnail src=/assets/examples/jbang/pixelblaze/full-setup.jpg alt="Full setup of this project"></div><a href=/assets/examples/jbang/pixelblaze/full-setup.jpg itemprop=contentUrl></a><figcaption><p>Full setup of this project</p></figcaption></figure></div><div class="box fancy-figure caption-position-center caption-effect-fade"><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(/assets/examples/jbang/pixelblaze/led-strip.jpg)><img itemprop=thumbnail src=/assets/examples/jbang/pixelblaze/led-strip.jpg alt="LED strip with three connections for power, ground, and data"></div><a href=/assets/examples/jbang/pixelblaze/led-strip.jpg itemprop=contentUrl></a><figcaption><p>LED strip with three connections for power, ground, and data</p></figcaption></figure></div><div class="box fancy-figure caption-position-center caption-effect-fade"><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(/assets/examples/jbang/pixelblaze/pixelblaze-output-expander.jpg)><img itemprop=thumbnail src=/assets/examples/jbang/pixelblaze/pixelblaze-output-expander.jpg alt="Pixelblaze Output Expander"></div><a href=/assets/examples/jbang/pixelblaze/pixelblaze-output-expander.jpg itemprop=contentUrl></a><figcaption><p>Pixelblaze Output Expander</p></figcaption></figure></div><div class="box fancy-figure caption-position-center caption-effect-fade"><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(/assets/examples/jbang/pixelblaze/raspberry-pi-connections.jpg)><img itemprop=thumbnail src=/assets/examples/jbang/pixelblaze/raspberry-pi-connections.jpg alt="Connections on the Raspberry Pi"></div><a href=/assets/examples/jbang/pixelblaze/raspberry-pi-connections.jpg itemprop=contentUrl></a><figcaption><p>Connections on the Raspberry Pi</p></figcaption></figure></div><div class="box fancy-figure caption-position-center caption-effect-fade"><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(/assets/examples/jbang/pixelblaze/pixelblaze-connections.jpg)><img itemprop=thumbnail src=/assets/examples/jbang/pixelblaze/pixelblaze-connections.jpg alt="Connections on the Pixelblaze Output Expander"></div><a href=/assets/examples/jbang/pixelblaze/pixelblaze-connections.jpg itemprop=contentUrl></a><figcaption><p>Connections on the Pixelblaze Output Expander</p></figcaption></figure></div><div class="box fancy-figure caption-position-center caption-effect-fade"><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><div class=img style=background-image:url(/assets/examples/jbang/pixelblaze/led-strip-connections.jpg)><img itemprop=thumbnail src=/assets/examples/jbang/pixelblaze/led-strip-connections.jpg alt="Connections for the LED strip"></div><a href=/assets/examples/jbang/pixelblaze/led-strip-connections.jpg itemprop=contentUrl></a><figcaption><p>Connections for the LED strip</p></figcaption></figure></div></div><script src=/js/load-photoswipe.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin=anonymous></script><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div></p><h3 id=enabling-serial>Enabling Serial</h3><p>To be able to control the serial link from software, the following steps must be followed:</p><ul><li>In terminal: <code>sudo raspi-config</code></li><li>Go to &ldquo;Interface Options&rdquo;</li><li>Go to &ldquo;Serial Port&rdquo;</li><li>Select &ldquo;No&rdquo; for &ldquo;login shell&rdquo;</li><li>Select &ldquo;Yes&rdquo; for &ldquo;hardware enabled&rdquo;</li></ul><h3 id=status-of-the-pixelblaze-output-expander-leds>Status of the Pixelblaze Output Expander LEDs</h3><ul><li>Fading / pulsing orange: Has not seen any valid looking data.</li><li>Solid orange (for a short time): Received expander data.</li><li>Green LED (for a short time): Received data for its channels and is drawing.</li></ul><h2 id=application>Application</h2><div class="notices warning"><p>Before proceeding with this example, make sure that you have a Raspberry Pi prepared to execute Java code with JBang as <a href=https://pi4j.com/examples/jbang/ target=_blank rel=noopener>explained here</a>.</p></div><p>Jeff Vyduna and Ben Hencke of ElectroMage, the creators of Pixelblaze, provided example Java code for this project. The serial data format is <a href=https://github.com/simap/pixelblaze_output_expander/tree/v3.x target=_blank rel=noopener>documented on GitHub</a>. What the code is doing in short:</p><ul><li>Open serial communication. Depending on the type of board and the connection you are using (GPIO pin, or other serial connection), this can be a different port. Most probably it will be <code>/dev/ttyS0</code> (Raspberry Pi 4 or earlier), or <code>/dev/ttyAMA0</code> (Raspberry Pi 5).</li><li>Use BaudRate <code>2000000</code>, this is a hard requirement for the PBOE.</li><li>Send a byte array of RGB values for each LED.</li><li>Send a <code>drawAll</code> command to put the values on the LEDs.</li><li>Repeat as much as you want the two previous steps&mldr;</li><li>Before the application stops, close the serial port.</li></ul><h3 id=helperpixelblazeoutputexpanderhelper>helper.PixelBlazeOutputExpanderHelper</h3><p>This example project doesn&rsquo;t use the Pi4J serial communication (because it doesn&rsquo;t support this baud rate - at this moment), but instead the <code>com.fazecast:jSerialComm:2.10.2</code> library. Although we are using JBang and can execute the code with a single file, a separate file is used for the logic to interact with the PBOE, so it can be used in other examples.</p><p>Inside <code>PixelBlazeOutputExpanderHelper</code>, an inner class is used to set up the serial communication and provide a write method. This is the actual part of the code that is interacting with the PBOE via the serial port.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ExpanderDataWriteAdapter</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> SerialPort port <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String portPath;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ExpanderDataWriteAdapter</span> (String portPath) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>portPath</span> <span style=color:#f92672>=</span> portPath;
</span></span><span style=display:flex><span>        openPort();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>openPort</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (port <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Closing &#34;</span> <span style=color:#f92672>+</span> portPath);
</span></span><span style=display:flex><span>            port.<span style=color:#a6e22e>closePort</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            port <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>//set to null in case getCommPort throws, port will remain null.</span>
</span></span><span style=display:flex><span>            port <span style=color:#f92672>=</span> SerialPort.<span style=color:#a6e22e>getCommPort</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>portPath</span>);
</span></span><span style=display:flex><span>            port.<span style=color:#a6e22e>setBaudRate</span>(2000000);
</span></span><span style=display:flex><span>            port.<span style=color:#a6e22e>setComPortTimeouts</span>(SerialPort.<span style=color:#a6e22e>TIMEOUT_NONBLOCKING</span>, 0, 0);
</span></span><span style=display:flex><span>            port.<span style=color:#a6e22e>openPort</span>(0, 8192, 8192);
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Opening &#34;</span> <span style=color:#f92672>+</span> portPath);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception e) {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Could not open serial port &#34;</span> <span style=color:#f92672>+</span> e.<span style=color:#a6e22e>getMessage</span>());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>closePort</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (port <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Closing &#34;</span> <span style=color:#f92672>+</span> portPath);
</span></span><span style=display:flex><span>            port.<span style=color:#a6e22e>closePort</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>write</span>(<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> data) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> lastErrorCode <span style=color:#f92672>=</span> port <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>?</span> port.<span style=color:#a6e22e>getLastErrorCode</span>() : 0;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>boolean</span> isOpen <span style=color:#f92672>=</span> port <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> port.<span style=color:#a6e22e>isOpen</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (port <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span>isOpen <span style=color:#f92672>||</span> lastErrorCode <span style=color:#f92672>!=</span> 0) {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Port was open:&#34;</span> <span style=color:#f92672>+</span> isOpen <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;, last error:&#34;</span> <span style=color:#f92672>+</span> lastErrorCode);
</span></span><span style=display:flex><span>            openPort();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        port.<span style=color:#a6e22e>writeBytes</span>(data, data.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The remaining part of <code>PixelBlazeOutputExpanderHelper</code> exposes a few methods to write RGB values to the strip, or clear them all, but hides all the &ldquo;internal logic&rdquo; in private methods.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PixelBlazeOutputExpanderHelper</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> CH_WS2812_DATA <span style=color:#f92672>=</span> 1;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span> CH_DRAW_ALL <span style=color:#f92672>=</span> 2;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> ExpanderDataWriteAdapter adapter;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>PixelBlazeOutputExpanderHelper</span>(String address) {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Initializing serial&#34;</span>);
</span></span><span style=display:flex><span>        adapter <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ExpanderDataWriteAdapter(address);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sendAllOff</span>(<span style=color:#66d9ef>int</span> channel, <span style=color:#66d9ef>int</span> numberOfLeds) {
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sendColors</span>(<span style=color:#66d9ef>int</span> channel, <span style=color:#66d9ef>int</span> bytesPerPixel, <span style=color:#66d9ef>int</span> rIndex, <span style=color:#66d9ef>int</span> gIndex, <span style=color:#66d9ef>int</span> bIndex, <span style=color:#66d9ef>int</span> wIndex, <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> pixelData, <span style=color:#66d9ef>boolean</span> debug) {
</span></span><span style=display:flex><span>       ...
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>closePort</span>() {
</span></span><span style=display:flex><span>        adapter.<span style=color:#a6e22e>closePort</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sendDrawAll</span>() {
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>writeCrc</span>(CRC32 crc) {
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>packInt</span>(<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> outgoing, <span style=color:#66d9ef>int</span> index, <span style=color:#66d9ef>int</span> val) {
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> ByteBuffer <span style=color:#a6e22e>initHeaderBuffer</span>(<span style=color:#66d9ef>int</span> size, <span style=color:#66d9ef>byte</span> channel, <span style=color:#66d9ef>byte</span> command) {
</span></span><span style=display:flex><span>        ByteBuffer buffer <span style=color:#f92672>=</span> ByteBuffer.<span style=color:#a6e22e>allocate</span>(size);
</span></span><span style=display:flex><span>        buffer.<span style=color:#a6e22e>order</span>(ByteOrder.<span style=color:#a6e22e>LITTLE_ENDIAN</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        buffer.<span style=color:#a6e22e>put</span>((<span style=color:#66d9ef>byte</span>) <span style=color:#e6db74>&#39;U&#39;</span>);
</span></span><span style=display:flex><span>        buffer.<span style=color:#a6e22e>put</span>((<span style=color:#66d9ef>byte</span>) <span style=color:#e6db74>&#39;P&#39;</span>);
</span></span><span style=display:flex><span>        buffer.<span style=color:#a6e22e>put</span>((<span style=color:#66d9ef>byte</span>) <span style=color:#e6db74>&#39;X&#39;</span>);
</span></span><span style=display:flex><span>        buffer.<span style=color:#a6e22e>put</span>((<span style=color:#66d9ef>byte</span>) <span style=color:#e6db74>&#39;L&#39;</span>);
</span></span><span style=display:flex><span>        buffer.<span style=color:#a6e22e>put</span>(channel);
</span></span><span style=display:flex><span>        buffer.<span style=color:#a6e22e>put</span>(command);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> buffer;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ExpanderDataWriteAdapter</span> {
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=pixelblazeoutputexpander>PixelblazeOutputExpander</h3><p>Thanks to the helper-class, the code inside the actual demo is very small.</p><h4 id=jbang-configuration-and-imports>JBang Configuration and Imports</h4><p>As with each JBang example, we need to define the first script line and the dependencies, one in this case, and we need to include the helper-source. Only two imports are needed for this example.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>///usr/bin/env jbang &#34;$0&#34; &#34;$@&#34; ; exit $?</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//DEPS com.fazecast:jSerialComm:2.10.2</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//SOURCES helper/PixelBlazeOutputExpanderHelper.java</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> helper.PixelBlazeOutputExpanderHelper;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Random;
</span></span></code></pre></div><h4 id=initialize-the-helper>Initialize the Helper</h4><p>The main method needs to initialize the helper and contains a helper method to send a specific color, one LED at a time, to a strip:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> PixelBlazeOutputExpanderHelper helper;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> InterruptedException {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Depending on the type of board and the connection you are using </span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// (GPIO pin, or other serial connection), this can be a different port. </span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Most probably it will be `/dev/ttyS0` (Raspberry Pi 4 or earlier), </span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// or `/dev/ttyAMA0` (Raspberry Pi 5).</span>
</span></span><span style=display:flex><span>        helper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PixelBlazeOutputExpanderHelper(<span style=color:#e6db74>&#34;/dev/ttyS0&#34;</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// RGB commands will be added here</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        helper.<span style=color:#a6e22e>closePort</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sendOneByOne</span>(<span style=color:#66d9ef>int</span> channel, <span style=color:#66d9ef>int</span> numberOfLeds, <span style=color:#66d9ef>byte</span> red, <span style=color:#66d9ef>byte</span> green, <span style=color:#66d9ef>byte</span> blue) <span style=color:#66d9ef>throws</span> InterruptedException {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;One by one on channel &#34;</span> <span style=color:#f92672>+</span> channel);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> numberOfLeds; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> oneLed <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>numberOfLeds <span style=color:#f92672>*</span> BYTES_PER_PIXEL<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>            oneLed<span style=color:#f92672>[</span>i <span style=color:#f92672>*</span> BYTES_PER_PIXEL<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> red;
</span></span><span style=display:flex><span>            oneLed<span style=color:#f92672>[</span>(i <span style=color:#f92672>*</span> BYTES_PER_PIXEL) <span style=color:#f92672>+</span> 1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> green;
</span></span><span style=display:flex><span>            oneLed<span style=color:#f92672>[</span>(i <span style=color:#f92672>*</span> BYTES_PER_PIXEL) <span style=color:#f92672>+</span> 2<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> blue;
</span></span><span style=display:flex><span>            helper.<span style=color:#a6e22e>sendColors</span>(channel, BYTES_PER_PIXEL, 1, 0, 2, 0, oneLed, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>            Thread.<span style=color:#a6e22e>sleep</span>(50);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><h4 id=controlling-the-leds>Controlling the LEDs</h4><p>With all this code in place, we can start sending color data to the LED strip. The idea is to send a byte array containing a value for each color of the LEDs.</p><p>For instance, to send these colors to the first four LEDs, when using RGB-leds:</p><p>1 Red
2 Green
3 Blue
4 White</p><p>The byte array will look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> pixeldata <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>12<span style=color:#f92672>]</span>; <span style=color:#75715e>// 3 colors * 4 leds</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Red = 0xff0000</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Green = 0x00ff00</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>4<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>5<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// blue = 0x0000ff</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>6<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>7<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>8<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// White = 0xffffff</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>9<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>10<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>11<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span></code></pre></div><h4 id=number-of-colors-per-led>Number of colors per LED</h4><p>A LED on a strip can contain three inner LEDs for RGB, or four for RGBW. In case of RGBW, you need to adapt the script to define <code>BYTES_PER_PIXEL = 4</code>, and your byte array with the color values needs to include four values per LED.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 3 colors per LED, White = 0xffffff</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 4 colors per LED, White = 0x000000ff</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0x00;
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span></code></pre></div><h4 id=order-of-the-color-values>Order of the color values</h4><p>Test the red, green, and blue output to define how the RGB colors are ordered in the PBOE controller and/or LED strip. You can define the relationship between the colors in your byte array with the actual led strip in the <code>sendColors</code> method, with the <code>int rIndex, int gIndex, int bIndex, int wIndex</code> parameters. If you are using RGB-leds and 3 bytes per pixel, the <code>wIndex</code> parameter is ignored.</p><h4 id=sending-color-values>Sending color values</h4><p>The example code uses multiple byte arrays to send various colors and effects to a strip with 11 LEDs, connected to the channel 0 pins of the PBOE.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> BYTES_PER_PIXEL <span style=color:#f92672>=</span> 3;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> CHANNEL_STRIP_SHORT <span style=color:#f92672>=</span> 0;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> NUMBER_OF_LEDS_STRIP_SHORT <span style=color:#f92672>=</span> 11;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> InterruptedException{
</span></span><span style=display:flex><span>        helper<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> PixelBlazeOutputExpanderHelper(<span style=color:#e6db74>&#34;/dev/ttyS0&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// All off on, short LED strip</span>
</span></span><span style=display:flex><span>        helper.<span style=color:#a6e22e>sendAllOff</span>(CHANNEL_STRIP_SHORT,NUMBER_OF_LEDS_STRIP_SHORT);
</span></span><span style=display:flex><span>        Thread.<span style=color:#a6e22e>sleep</span>(500);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// One by one red, short LED strip</span>
</span></span><span style=display:flex><span>        sendOneByOne(CHANNEL_STRIP_SHORT,NUMBER_OF_LEDS_STRIP_SHORT,(<span style=color:#66d9ef>byte</span>)0xff,(<span style=color:#66d9ef>byte</span>)0x00,(<span style=color:#66d9ef>byte</span>)0x00);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// All the same color red, green, blue, short LED strip</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> color<span style=color:#f92672>=</span>0;color<span style=color:#f92672>&lt;</span>BYTES_PER_PIXEL; color<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;All &#34;</span><span style=color:#f92672>+</span>(color<span style=color:#f92672>==</span>0<span style=color:#f92672>?</span><span style=color:#e6db74>&#34;red&#34;</span>:(color<span style=color:#f92672>==</span>1<span style=color:#f92672>?</span><span style=color:#e6db74>&#34;green&#34;</span>:<span style=color:#e6db74>&#34;blue&#34;</span>)));
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span>allSame<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>NUMBER_OF_LEDS_STRIP_SHORT<span style=color:#f92672>*</span>BYTES_PER_PIXEL<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span>0;i<span style=color:#f92672>&lt;</span>NUMBER_OF_LEDS_STRIP_SHORT; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>                allSame<span style=color:#f92672>[</span>(BYTES_PER_PIXEL<span style=color:#f92672>*</span>i)<span style=color:#f92672>+</span>color<span style=color:#f92672>]=</span>(<span style=color:#66d9ef>byte</span>)0xff;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            helper.<span style=color:#a6e22e>sendColors</span>(CHANNEL_STRIP_SHORT,BYTES_PER_PIXEL,1,0,2,0,allSame,<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>            Thread.<span style=color:#a6e22e>sleep</span>(1000);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Fill strip with random colors, short LED strip</span>
</span></span><span style=display:flex><span>        Random rd<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> Random();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span>0;i<span style=color:#f92672>&lt;</span> 5;i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Random colors &#34;</span><span style=color:#f92672>+</span>(i<span style=color:#f92672>+</span>1));
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span>random<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>NUMBER_OF_LEDS_STRIP_SHORT<span style=color:#f92672>*</span>BYTES_PER_PIXEL<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>            rd.<span style=color:#a6e22e>nextBytes</span>(random);
</span></span><span style=display:flex><span>            helper.<span style=color:#a6e22e>sendColors</span>(CHANNEL_STRIP_SHORT,BYTES_PER_PIXEL,1,0,2,0,random,<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>            Thread.<span style=color:#a6e22e>sleep</span>(1000);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Red alert, short LED strip</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span>red<span style=color:#f92672>=</span><span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>NUMBER_OF_LEDS_STRIP_SHORT<span style=color:#f92672>*</span>BYTES_PER_PIXEL<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(i<span style=color:#f92672>=</span>0;i<span style=color:#f92672>&lt;</span>NUMBER_OF_LEDS_STRIP_SHORT; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            red<span style=color:#f92672>[</span>i<span style=color:#f92672>*</span>BYTES_PER_PIXEL<span style=color:#f92672>]=</span>(<span style=color:#66d9ef>byte</span>)0xff;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(i<span style=color:#f92672>=</span>0;i<span style=color:#f92672>&lt;</span> 5;i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;All red&#34;</span>);
</span></span><span style=display:flex><span>            helper.<span style=color:#a6e22e>sendColors</span>(CHANNEL_STRIP_SHORT,BYTES_PER_PIXEL,1,0,2,0,red,<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>            Thread.<span style=color:#a6e22e>sleep</span>(100);
</span></span><span style=display:flex><span>            helper.<span style=color:#a6e22e>sendAllOff</span>(CHANNEL_STRIP_SHORT,NUMBER_OF_LEDS_STRIP_SHORT);
</span></span><span style=display:flex><span>            Thread.<span style=color:#a6e22e>sleep</span>(100);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The example application also contains demos for a longer strip with 300 LEDs (5 meter) and a 8*32 matrix, connected to the second (index 1) and third channel (index 2).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> CHANNEL_STRIP_LONG <span style=color:#f92672>=</span> 1;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> CHANNEL_MATRIX <span style=color:#f92672>=</span> 2;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> NUMBER_OF_LEDS_STRIP_LONG <span style=color:#f92672>=</span> 300;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> NUMBER_OF_LEDS_MATRIX <span style=color:#f92672>=</span> 256; <span style=color:#75715e>// 8*32</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// One by one red/green/blue on long strip, 5 meter with 60 LEDs/meter</span>
</span></span><span style=display:flex><span>    sendOneByOne(CHANNEL_STRIP_LONG, NUMBER_OF_LEDS_STRIP_LONG, (<span style=color:#66d9ef>byte</span>) 0xff, (<span style=color:#66d9ef>byte</span>) 0x00, (<span style=color:#66d9ef>byte</span>) 0x00);
</span></span><span style=display:flex><span>    sendOneByOne(CHANNEL_STRIP_LONG, NUMBER_OF_LEDS_STRIP_LONG, (<span style=color:#66d9ef>byte</span>) 0x00, (<span style=color:#66d9ef>byte</span>) 0xff, (<span style=color:#66d9ef>byte</span>) 0x00);
</span></span><span style=display:flex><span>    sendOneByOne(CHANNEL_STRIP_LONG, NUMBER_OF_LEDS_STRIP_LONG, (<span style=color:#66d9ef>byte</span>) 0x00, (<span style=color:#66d9ef>byte</span>) 0x00, (<span style=color:#66d9ef>byte</span>) 0xff);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Flash all red/white on long strip 1, 5 meter with 60 LEDs/meter</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> fiveMeterRed <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>NUMBER_OF_LEDS_STRIP_LONG <span style=color:#f92672>*</span> BYTES_PER_PIXEL<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> fiveMeterWhite <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>NUMBER_OF_LEDS_STRIP_LONG <span style=color:#f92672>*</span> BYTES_PER_PIXEL<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> NUMBER_OF_LEDS_STRIP_LONG; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        fiveMeterRed<span style=color:#f92672>[</span>i<span style=color:#f92672>*</span>BYTES_PER_PIXEL<span style=color:#f92672>]=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span>        fiveMeterWhite<span style=color:#f92672>[</span>i<span style=color:#f92672>*</span>BYTES_PER_PIXEL<span style=color:#f92672>]=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span>        fiveMeterWhite<span style=color:#f92672>[</span>(i<span style=color:#f92672>*</span>BYTES_PER_PIXEL) <span style=color:#f92672>+</span> 1<span style=color:#f92672>]=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span>        fiveMeterWhite<span style=color:#f92672>[</span>(i<span style=color:#f92672>*</span>BYTES_PER_PIXEL) <span style=color:#f92672>+</span> 2<span style=color:#f92672>]=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> 5; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;All RED on LED strip on channel 1&#34;</span>);
</span></span><span style=display:flex><span>        helper.<span style=color:#a6e22e>sendColors</span>(CHANNEL_STRIP_LONG, BYTES_PER_PIXEL, 1, 0, 2, 0, fiveMeterRed, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>        Thread.<span style=color:#a6e22e>sleep</span>(500);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;All RED on LED strip on channel 1&#34;</span>);
</span></span><span style=display:flex><span>        helper.<span style=color:#a6e22e>sendColors</span>(CHANNEL_STRIP_LONG, BYTES_PER_PIXEL, 1, 0, 2, 0, fiveMeterWhite, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>        Thread.<span style=color:#a6e22e>sleep</span>(500);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// All off, long LED strip</span>
</span></span><span style=display:flex><span>    helper.<span style=color:#a6e22e>sendAllOff</span>(CHANNEL_STRIP_LONG, NUMBER_OF_LEDS_STRIP_LONG);
</span></span><span style=display:flex><span>    Thread.<span style=color:#a6e22e>sleep</span>(100);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// All red, 8*32 LED matrix</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> redMatrix <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>NUMBER_OF_LEDS_MATRIX <span style=color:#f92672>*</span> BYTES_PER_PIXEL<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> NUMBER_OF_LEDS_MATRIX; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        redMatrix<span style=color:#f92672>[</span>i<span style=color:#f92672>*</span>BYTES_PER_PIXEL<span style=color:#f92672>]=</span> (<span style=color:#66d9ef>byte</span>) 0xff;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> 5; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;All red on LED matrix on channel 2&#34;</span>);
</span></span><span style=display:flex><span>        helper.<span style=color:#a6e22e>sendColors</span>(CHANNEL_MATRIX, BYTES_PER_PIXEL, 1, 0, 2, 0, redMatrix, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>        Thread.<span style=color:#a6e22e>sleep</span>(100);
</span></span><span style=display:flex><span>        helper.<span style=color:#a6e22e>sendAllOff</span>(CHANNEL_MATRIX, NUMBER_OF_LEDS_MATRIX);
</span></span><span style=display:flex><span>        Thread.<span style=color:#a6e22e>sleep</span>(100);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><h2 id=running-the-application>Running the Application</h2><p>No <code>sudo</code> is needed for serial communication with the <code>jSerialComm</code> library, so the application can be started with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ jbang PixelblazeOutputExpander.java 
</span></span><span style=display:flex><span>Initializing serial
</span></span><span style=display:flex><span>Opening /dev/ttyS0
</span></span><span style=display:flex><span>All off on channel <span style=color:#ae81ff>0</span> with <span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>All off on channel <span style=color:#ae81ff>1</span> with <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>All off on channel <span style=color:#ae81ff>2</span> with <span style=color:#ae81ff>256</span>
</span></span><span style=display:flex><span>One by one on channel 0, will take 2s
</span></span><span style=display:flex><span>All red
</span></span><span style=display:flex><span>All green
</span></span><span style=display:flex><span>All blue
</span></span><span style=display:flex><span>Random colors <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>..
</span></span><span style=display:flex><span>All red
</span></span><span style=display:flex><span>All off on channel <span style=color:#ae81ff>0</span> with <span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>One by one on channel 1, will take 6s
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>All red on LED strip on channel <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>All off on channel <span style=color:#ae81ff>1</span> with <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>All red on LED matrix on channel <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Closing /dev/ttyS0
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>I&rsquo;m still curious to see the reliability of this serial control for LED strips in combination with other loads on the Raspberry Pi, but the Pixelblaze Output Expander is a great way to easily control such strips!</p><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1738069976></script><script src=/js/perfect-scrollbar.min.js?1738069976></script><script src=/js/perfect-scrollbar.jquery.min.js?1738069976></script><script src=/js/jquery.sticky.js?1738069976></script><script src=/js/featherlight.min.js?1738069976></script><script src=/js/highlight.pack.js?1738069976></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1738069976></script><script src=/js/learn.js?1738069976></script><script src=/js/hugo-learn.js?1738069976></script><script src=/mermaid/mermaid.js?1738069976></script><script>mermaid.initialize({startOnLoad:!0})</script><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script><script type=text/javascript>docsearch({appId:"QJ0EB8YHN3",apiKey:"8ddde1d36a62d9e2d7c4333239e6a2fc",indexName:"pi4j",container:"#docsearch",debug:!0})</script><script async data-id=101436817 src=//static.getclicky.com/js></script></body></html>